<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AirScript by Polygon Miden</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="description/main.html"><strong aria-hidden="true">2.</strong> Language Description</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="description/syntax.html"><strong aria-hidden="true">2.1.</strong> Syntax overview</a></li><li class="chapter-item expanded "><a href="description/structure.html"><strong aria-hidden="true">2.2.</strong> File structure</a></li><li class="chapter-item expanded "><a href="description/declarations.html"><strong aria-hidden="true">2.3.</strong> Type declarations</a></li><li class="chapter-item expanded "><a href="description/constraints.html"><strong aria-hidden="true">2.4.</strong> Constraint descriptions</a></li><li class="chapter-item expanded "><a href="description/example.html"><strong aria-hidden="true">2.5.</strong> AirScript Example</a></li></ol></li><li class="chapter-item expanded "><a href="implementation.html"><strong aria-hidden="true">3.</strong> Language Implementation</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AirScript by Polygon Miden</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Polygon Miden's AirScript is designed to make it simple to describe AIR constraints and generate efficient and accurate code in the required target language.</p>
<h2 id="current-version"><a class="header" href="#current-version">Current Version</a></h2>
<p>Currently, AirScript is on version 0.1, which supports a simple syntax for describing air constraints and generation of Rust code targeting the <a href="https://github.com/novifinancial/winterfell">Winterfell prover</a>.</p>
<p>The simplified version of the language is based on <a href="https://github.com/maticnetwork/miden/discussions/254">this discussion</a>, but only includes the following:</p>
<ul>
<li>declaring trace columns for main and auxiliary traces as a vector (e.g. <code>main: [a, b, c]</code> but not <code>main[a, b, c[2]]</code>)</li>
<li>declaring public inputs where each public input is a named vector (e.g. <code>stack_inputs: [16]</code>)</li>
<li>declaring periodic columns</li>
<li>enforcing boundary constraints for main and auxiliary traces using trace columns, public inputs, and inline scalar constants</li>
<li>enforcing transition constraints for main and auxiliary traces using trace columns, periodic columns, and inline scalar constants</li>
</ul>
<p>The language will be specified in detail in the rest of this book.</p>
<h3 id="cli"><a class="header" href="#cli">CLI</a></h3>
<p>There is a command-line interface available for transpiling AirScript files to Rust. There are also several example <code>.air</code> files written in AirScript which can be found in the <code>examples/</code> directory.</p>
<p>To use the CLI, first run:</p>
<pre><code>cargo build --release
</code></pre>
<p>Then, run the <code>airc</code> target with the <code>transpile</code> option and specify your input file with <code>-i</code>. For example:</p>
<pre><code>./target/release/airc transpile -i examples/system.air
</code></pre>
<p>You can use the <code>help</code> option to see other available options.</p>
<pre><code>./target/release/airc transpile --help
</code></pre>
<h2 id="future-work"><a class="header" href="#future-work">Future Work</a></h2>
<p>The following changes are some of the improvements under consideration for future releases.</p>
<ul>
<li>more advanced language functionality for better ergonomics and modularity, such as:
<ul>
<li>modules and imports</li>
<li>variable declarations (e.g. <code>let x = k1 * c[1]'</code>)</li>
<li>named constants (e.g. in a <code>constants</code> section), including:
<ul>
<li>vector constants</li>
<li>matrix constants</li>
</ul>
</li>
<li>python-style list comprehension (and other &quot;convenience&quot; syntax)</li>
<li>support for functions</li>
<li>support for evaluators</li>
<li>support for selectors</li>
</ul>
</li>
<li>optimizations, such as:
<ul>
<li>removing unnecessary nodes from the <code>AlgebraicGraph</code> of transition constraints</li>
<li>combining transition constraints with mutually exclusive selectors to reduce the total number of constraints</li>
</ul>
</li>
<li>additional language targets for simplifying verifier implementations:
<ul>
<li>Solidity</li>
<li>Miden Assembly</li>
</ul>
</li>
<li>formal verification</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="language-description"><a class="header" href="#language-description">Language Description</a></h1>
<ul>
<li><a href="description/./syntax.html">Syntax overview</a></li>
<li><a href="description/./structure.html">File structure</a></li>
<li><a href="description/./declarations.html">Type declarations</a></li>
<li><a href="description/./constraints.html">Constraint descriptions</a></li>
<li><a href="description/./example.html">AirScript example</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="reserved-keywords-and-basic-types"><a class="header" href="#reserved-keywords-and-basic-types">Reserved keywords and basic types</a></h1>
<p>This page specifies the basic syntax, types, and keywords of AirScript.</p>
<h2 id="keywords"><a class="header" href="#keywords">Keywords</a></h2>
<p>AirScript defines the following keywords:</p>
<ul>
<li><code>rand</code>: used to access random values provided by the verifier.</li>
<li><code>def</code>: used to <a href="description/./structure.html">define the name</a> of an AirScript module.</li>
<li><code>boundary_constraints</code>: used to declare the <a href="description/./structure.html#source-sections">source section</a> where the <a href="description/./constraints.html#boundary_constraints">boundary constraints are described</a>.
<ul>
<li><code>first</code>: used to access the value of a trace column at the first row of the trace. <em>It may only be used when defining boundary constraints.</em></li>
<li><code>last</code>: used to access the value of a trace column at the last row of the trace. <em>It may only be used when defining boundary constraints.</em></li>
</ul>
</li>
<li><code>enf</code>: used to describe a single <a href="description/./constraints.html">constraint</a>.</li>
<li><code>public_inputs</code>: used to declare the <a href="description/./structure.html#source-sections">source section</a> where the <a href="description/./declarations.html">public inputs are declared</a>. <em>They may only be referenced when defining boundary constraints.</em></li>
<li><code>periodic_columns</code>: used to declare the <a href="description/./structure.html#source-sections">source section</a> where the <a href="description/./declarations.html">periodic columns are declared</a>. <em>They may only be referenced when defining transition constraints.</em></li>
<li><code>trace_columns</code>: used to declare the <a href="description/./structure.html#source-sections">source section</a> where the <a href="description/./declarations.html">execution trace is described</a>.
<ul>
<li><code>main</code>: used to declare the main execution trace.</li>
<li><code>aux</code>: used to declare the auxiliary execution trace.</li>
</ul>
</li>
<li><code>transition_constraints</code>: used to declare the <a href="description/./structure.html#source-sections">source section</a> where the <a href="description/./constraints.html#transition_constraints">transition constraints are described</a>.</li>
</ul>
<h2 id="built-in-variables"><a class="header" href="#built-in-variables">Built-in variables</a></h2>
<p>Built-in variables are identified by the starting character ``.</p>
<h3 id="randcurrentlytheonlybuiltinisrand-which-is-used-to-get-random-values-provided-by-the-verifier"><a class="header" href="#randcurrentlytheonlybuiltinisrand-which-is-used-to-get-random-values-provided-by-the-verifier"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">u</span><span class="mord mathnormal">rre</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">tl</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal">eo</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">b</span><span class="mord mathnormal">u</span><span class="mord mathnormal">i</span><span class="mord mathnormal">lt</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">ini</span><span class="mord mathnormal">s</span><span class="mord">‘</span></span></span></span>rand`, which is used to get random values provided by the verifier.</a></h3>
<p>These random values may be accessed by using the indexing operator on <code>&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;an&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;‘.&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;ore&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;am&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.01968em;&quot;&gt;pl&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;‘&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;rand[i]</code> provides the <code>ith</code> random value.</p>
<p>Random values may only be accessed within source sections for constraints, i.e. the <a href="description/./constraints.html#boundary-constraints-boundary_constraints"><code>boundary_constraints</code> section</a> and the <a href="description/./constraints.html#transition-constraints-transition_constraints"><code>transition_constraints</code> section</a>.</p>
<h2 id="delimiters-and-special-characters"><a class="header" href="#delimiters-and-special-characters">Delimiters and special characters</a></h2>
<ul>
<li><code>:</code> is used as a delimiter when declaring <a href="description/./structure.html#source-sections">source sections</a> and <a href="description/./declarations.html">types</a></li>
<li><code>.</code> is used to access a boundary on a trace column, e.g. <code>a.first</code> or <code>a.last</code></li>
<li><code>[</code> and <code>]</code> are used for defining arrays in <a href="description/./declarations.html">type declarations</a> and for indexing in <a href="description/./constraints.html">constraint descriptions</a></li>
<li><code>,</code> is used as a delimiter for defining arrays in <a href="description/./declarations.html">type declarations</a></li>
<li><code>&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;‘&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;se&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;ec&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;ia&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;lt&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.07153em;&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;rre&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.01968em;&quot;&gt;tl&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;so&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;se&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;‘&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;rand</code> for accessing random values.</li>
</ul>
<h2 id="identifiers"><a class="header" href="#identifiers">Identifiers</a></h2>
<p>Valid identifiers are strings that start with a letter <code>a-z</code> or <code>A-Z</code> followed by any combination of letters, digits <code>0-9</code> or an underscore <code>_</code>.</p>
<h2 id="numbers"><a class="header" href="#numbers">Numbers</a></h2>
<p>The only supported numbers are integers, and all integers are parsed as u64. Using a number larger than 2^64 - 1 will result in a <code>ParseError</code>.</p>
<h2 id="operations"><a class="header" href="#operations">Operations</a></h2>
<p>The following operations are supported in <a href="description/./constraints.html">constraint descriptions</a> with the specified syntax:</p>
<ul>
<li>Equality (<code>a = b</code>)</li>
<li>Addition (<code>a + b</code>)</li>
<li>Subtraction (<code>a - b</code>)</li>
<li>Multiplication (<code>a * b</code>)</li>
<li>Exponentiation by a constant integer x (<code>a^x</code>)</li>
</ul>
<p>The following operations are <strong>not supported</strong>:</p>
<ul>
<li>Negation</li>
<li>Division</li>
<li>Inversion</li>
</ul>
<h3 id="parentheses-and-complex-expressions"><a class="header" href="#parentheses-and-complex-expressions">Parentheses and complex expressions</a></h3>
<p>Parentheses (<code>(</code> and <code>)</code>) are supported and can be included in any expression except exponentiation, where complex expressions are not allowed.</p>
<p>The following is allowed:</p>
<pre><code>a * (b + c)
</code></pre>
<p>The following is not allowed:</p>
<pre><code>a^(2 + 3)
</code></pre>
<h2 id="section-specific-accessors"><a class="header" href="#section-specific-accessors">Section-specific accessors</a></h2>
<p>These accessors may only be used in the specified <a href="description/./structure.html">source section</a> in which they are described below.</p>
<h3 id="boundary-constraints"><a class="header" href="#boundary-constraints"><a href="description/./constraints.html#boundary_constraints">Boundary constraints</a></a></h3>
<p>The following accessors may only be applied to trace columns when they are in boundary constraint definitions.</p>
<ul>
<li>First boundary (<code>.first</code>): accesses the trace column's value in the first row. It is only supported in <a href="description/./constraints.html#boundary_constraints">boundary constraint descriptions</a></li>
<li>Last boundary (<code>.last</code>): accesses the trace column's value in the first row. It is only supported in <a href="description/./constraints.html#boundary_constraints">boundary constraint descriptions</a></li>
</ul>
<p>The following accessor may only be applied to public inputs declared in <code>public_inputs</code> when they are referenced in boundary constraint definitions.</p>
<ul>
<li>Indexing (<code>input_name[i]</code>): public inputs may be accessed by using the indexing operator on the declared identifier name with an index value that is less than the declared size of its array.</li>
</ul>
<p>Here is an example of usage of first and last boundaries and a public input within a boundary constraint:</p>
<pre><code>trace_columns:
    main: [a]

public_inputs:
    stack_inputs: [4]
    stack_outputs: [4]

boundary_constraints:
    enf a.first = stack_inputs[0]
    enf a.last = stack_outputs[0]
</code></pre>
<h3 id="transition-constraints"><a class="header" href="#transition-constraints"><a href="description/./constraints.html#transition_constraints">Transition constraints</a></a></h3>
<p>The following accessor may only be applied to trace columns when they are referenced in transition constraint definitions.</p>
<ul>
<li>Next Row (<code>a'</code>): <code>'</code> is a postfix operator that indicates the value of the specified trace column in the next row. It is only supported in <a href="description/./constraints.html#transition_constraints">transition constraint descriptions</a>.</li>
</ul>
<p>Here is an example of usage of the Next Row operator within a transition constraint:</p>
<pre><code>trace_columns:
  main: [a]
  aux: [p]

transition_constraints:
  enf p' = p * a
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="file-structure"><a class="header" href="#file-structure">File Structure</a></h1>
<p>An AIR Script file consists of a name definition and several source sections which contain declarations and constraints. The declarations describe the shape of the execution trace to which constraints are applied and the public inputs, and periodic columns that are used for computing those constraints. The constraints describe boundary and transition constraints which must hold for an execution trace and set of public inputs in order for them to be valid (i.e. in order for a valid proof to be generated or verification to pass).</p>
<h2 id="air-name-definition"><a class="header" href="#air-name-definition">AIR name definition</a></h2>
<p>An AirScript file starts with a definition of the name of the AIR module, such as:</p>
<pre><code>def ExampleAir
</code></pre>
<p>It must:</p>
<ul>
<li>Begin with the <code>def</code> keyword, with no indentation.</li>
<li>Continue with a string that does not begin with a number.</li>
<li>End with a newline.</li>
</ul>
<h2 id="source-sections"><a class="header" href="#source-sections">Source sections</a></h2>
<p>All source sections must:</p>
<ul>
<li>Begin with a valid source section keyword, followed by <code>:</code> and a newline.</li>
<li>Have all contents in an indented block.</li>
</ul>
<p>This is an example of a well-formed source section:</p>
<pre><code># source section keyword
trace_columns:
    # indented content block
    main: [a, b, c, d]
    aux: [x, y, z]
</code></pre>
<p>Valid keywords for type declaration sections are the following:</p>
<ul>
<li><code>trace_columns</code></li>
<li><code>public_inputs</code></li>
<li><code>periodic_columns</code></li>
</ul>
<p>Valid keywords for constraint description sections are the following:</p>
<ul>
<li><code>boundary_constraints</code></li>
<li><code>transition_constraints</code></li>
</ul>
<p>By convention, type declaration sections precede constraint description sections, although this is not a requirement of the language.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="type-declaration-sections"><a class="header" href="#type-declaration-sections">Type declaration sections</a></h1>
<h2 id="trace-columns-trace_columns"><a class="header" href="#trace-columns-trace_columns">Trace columns (<code>trace_columns</code>)</a></h2>
<p>A <code>trace_columns</code> section contains declarations for <code>main</code> trace columns or <code>aux</code> (auxiliary) trace columns.</p>
<p>The <code>main</code> and <code>aux</code> declarations define the shape of the main and auxiliary execution traces respectively and declare identifiers which can be used to refer to each of the columns in that trace.</p>
<p><strong>A <code>trace_columns</code> section with a <code>main</code> declaration is required for an AIR defined in AirScript to be valid.</strong> The <code>aux</code> declaration is optional, but if it is defined then it must follow the <code>main</code> declaration.</p>
<p>The following is a valid <code>trace_columns</code> block:</p>
<pre><code>trace_columns:
    main: [a, b, c]
    aux: [d, e]
</code></pre>
<p>In the above example, the main execution trace for the AIR has 3 columns which can be referenced by <code>a</code>, <code>b</code>, and <code>c</code>. Internally, these identifiers will reference the trace columns with indices 0, 1, and 2 respectively. Similarly, the auxiliary execution trace has 2 columns which can be referenced by <code>d</code> and <code>e</code>.</p>
<h2 id="public-inputs-public_inputs"><a class="header" href="#public-inputs-public_inputs">Public inputs (<code>public_inputs</code>)</a></h2>
<p>A <code>public_inputs</code> section contains declarations for public inputs. Currently, each public input must be provided as a vector of a fixed size, but there is no limit to how many of them can be declared within the <code>public_inputs</code> section.</p>
<p><strong>Public inputs are required.</strong> There must be at least one pubic input declared.</p>
<p>Each public input is described by an identifier and an array length (<code>n</code>) in the following format:</p>
<pre><code>identifier: [n]
</code></pre>
<p>The following is an example of a valid <code>public_inputs</code> block:</p>
<pre><code>public_inputs:
    program_hash: [4]
    stack_inputs: [16]
    stack_outputs: [16]
</code></pre>
<p>In the above example, the public input <code>program_hash</code> is an array of length <code>4</code>. <code>stack_inputs</code> and <code>stack_outputs</code> are both arrays of length <code>16</code>.</p>
<p>Public inputs can be referenced by <a href="description/./constraints.html#boundary_constraints">boundary constraints</a> by using the identifier and an index. For example, the 3rd element of the <code>program_hash</code> declared above would be referenced as <code>program_hash[2]</code>.</p>
<h2 id="periodic-columns-periodic_columns"><a class="header" href="#periodic-columns-periodic_columns">Periodic columns (<code>periodic_columns</code>)</a></h2>
<p>A <code>periodic_columns</code> section contains declarations for periodic columns used in the description and evaluation of transition constraints. Each periodic column declares an array of periodic values which can then be referenced by the declared identifier.</p>
<p>There is no limit to how many of them can be declared within the <code>periodic_columns</code> section.</p>
<p><strong>Periodic columns are optional.</strong> It is equally valid to define an empty <code>periodic_columns</code> section or to omit the <code>periodic_columns</code> section declaration entirely.</p>
<p>Each periodic column is described by an identifier and an array of integers in the following format. These integers are the periodic values.</p>
<pre><code>identifier: [i, j, k, n]
</code></pre>
<p>The length of each of the array must be a power of two which is greater than or equal to <code>2</code>.</p>
<p>The following is an example of a valid <code>periodic_columns</code> block:</p>
<pre><code>periodic_columns:
    k0: [0, 0, 0, 1]
    k1: [1, 1, 1, 1, 1, 1, 1, 0]
</code></pre>
<p>In the above example, <code>k0</code> declares a periodic column with a cycle of length <code>4</code>, and <code>k1</code> declares a periodic column with a cycle of length <code>8</code>.</p>
<p>Periodic columns can be referenced by <a href="description/./constraints.html#transition_constraints">transition constraints</a> by using the column's identifier.</p>
<p>When constraints are evaluated, these periodic values always refer to the value of the column in the current row. For example, when evaluating a transition constraint such as <code>enf k0 * a = 0</code>, <code>k0</code> would be evaluated as <code>0</code> in rows <code>0</code>, <code>1</code>, <code>2</code> of the trace and as <code>1</code> in row <code>3</code>, and then the cycle would repeat. Attempting to refer to the &quot;next&quot; row of a periodic column, such as by <code>k0'</code>, is invalid and will cause a <code>ParseError</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="constraint-description-sections"><a class="header" href="#constraint-description-sections">Constraint description sections</a></h1>
<h2 id="boundary-constraints-boundary_constraints"><a class="header" href="#boundary-constraints-boundary_constraints">Boundary constraints (<code>boundary_constraints</code>)</a></h2>
<p>The <code>boundary_constraints</code> section consists of expressions describing the expected value of columns in the main or auxiliary traces at the specified boundary. Column boundaries can be selected using boundary accessors. Valid boundary accessors are <code>.first</code>, which selects the first cell of the column to which it is applied, and <code>.last</code>, which selects the last cell of the column column to which it is applied.</p>
<p><strong>Boundary constraints are required.</strong> The <code>boundary_constraints</code> section must be defined and contain at least one boundary constraint.</p>
<p>Boundary constraints that are defined against auxiliary columns or that use random values from the built-in <code>rand</code> array will be identified as auxiliary constraints.</p>
<p>A boundary constraint definition must:</p>
<ol>
<li>start with a block indentation and the <code>enf</code> keyword to indicate that the constraint must be <em>enforced</em>.</li>
<li>continue by specifying a column identifier with a boundary accessor, e.g. <code>a.first</code> or <code>a.last</code>.</li>
<li>continue with <code>=</code></li>
<li>continue with a right-hand-size &quot;value&quot; expression that evaluates to the required value of the specified column at the specified boundary. The expression may include numbers, trace columns, public inputs, random values, and any of the available <a href="description/./syntax.html#operations">operations</a>.</li>
<li>end with a newline.</li>
</ol>
<h3 id="simple-example-of-boundary-constraints"><a class="header" href="#simple-example-of-boundary-constraints">Simple example of boundary constraints</a></h3>
<p>The following is a simple example of a valid <code>boundary_constraints</code> block:</p>
<pre><code>def BoundaryConstraintsExample

trace_columns:
    main: [a]
    aux: [p]

public_inputs:
    &lt;omitted for brevity&gt;

boundary_constraints:
    # these are main constraints.
    enf a.first = 0
    enf a.last = 10

    # these are auxiliary constraints, since they are defined against auxiliary trace columns.
    enf p.first = 1
    enf p.last = 1

transition_constraints:
    &lt;omitted for brevity&gt;
</code></pre>
<h3 id="public-inputs-and-random-values"><a class="header" href="#public-inputs-and-random-values">Public inputs and random values</a></h3>
<p>Boundary constraints can access public input values and random values provided by the verifier in their value expressions.</p>
<p>To use public inputs, the public input must be declared in the <code>public_inputs</code> source section. They can be accessed using array indexing syntax, as described by the <a href="description/./syntax.html#section-specific-accessors">accessor syntax rules</a>.</p>
<p>Random values can be accessed by using array indexing syntax on the <code>rand</code> built-in, as described by the <a href="description/./syntax.html#section-specific-accessors">accessor syntax rules</a>.</p>
<h3 id="example-of-boundary-constraints-with-public-inputs-and-random-values"><a class="header" href="#example-of-boundary-constraints-with-public-inputs-and-random-values">Example of boundary constraints with public inputs and random values</a></h3>
<p>The following is an example of a valid <code>boundary_constraints</code> block that uses public inputs and random values:</p>
<pre><code>def BoundaryConstraintsExample

trace_columns:
    main: [a, b]
    aux: [p0, p1]

public_inputs:
    stack_inputs: [16]
    stack_outputs: [16]

boundary_constraints:
    # these are main constraints that use public input values.
    enf a.first = stack_inputs[0]
    enf a.last = stack_outputs[0]

    # these are auxiliary constraints that use public input values.
    enf p0.first = stack_inputs[1]
    enf p0.last = stack_outputs[1]

    # these are auxiliary constraints that use random values from the verifier.
    enf b.first = a + &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;an&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;rs&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathnormal mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;+&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;rand[0]) * (stack_inputs[3] + rand[1])

transition_constraints:
    &lt;omitted for brevity&gt;
</code></pre>
<h2 id="transition-constraints-transition_constraints"><a class="header" href="#transition-constraints-transition_constraints">Transition constraints (<code>transition_constraints</code>)</a></h2>
<p>The <code>transition_constraints</code> section consists of expressions describing constraints that must be true at each row of the execution trace in order for the proof to be valid.</p>
<p><strong>Transition constraints are required.</strong> The <code>transition_constraints</code> section must be defined and contain at least one transition constraint.</p>
<p>Transition constraints that are defined against auxiliary columns or that use random values from the built-in <code>rand</code> array will be identified as auxiliary constraints.</p>
<p>A transition constraint definition must:</p>
<ol>
<li>start with a block indentation and the <code>enf</code> keyword to indicate that the constraint must be <em>enforced</em>.</li>
<li>continue with an equality expression that describes the constraint. The expression may include numbers, trace columns, periodic columns, random values, and any of the available <a href="description/./syntax.html#operations">operations</a>.</li>
<li>end with a newline.</li>
</ol>
<h3 id="current-and-next-rows"><a class="header" href="#current-and-next-rows">Current and next rows</a></h3>
<p>Transition constraints have access to values in the &quot;current&quot; row of the trace to which the constraint is being applied, as well as the &quot;next&quot; row of the trace. The value of a trace column in the next row is specified with the <code>'</code> postfix operator, as described by the <a href="description/./syntax.html#section-specific-accessors">accessor syntax rules</a>.</p>
<h3 id="simple-example-of-transition-constraints"><a class="header" href="#simple-example-of-transition-constraints">Simple example of transition constraints</a></h3>
<p>The following is a simple example of a valid <code>transition_constraints</code> block using values from the current and next rows of the main and auxiliary traces:</p>
<pre><code>def TransitionConstraintsExample

trace_columns:
    main: [a, b]
    aux: [p]

public_inputs:
    &lt;omitted for brevity&gt;

boundary_constraints:
    &lt;omitted for brevity&gt;

transition_constraints:
    # these are main constraints. they both express the same constraint.
    enf a' = a + 1
    enf b' - b - 1 = 0

    # this is an auxiliary constraint, since it uses an auxiliary trace column.
    enf p = p' * a
</code></pre>
<h3 id="periodic-columns-and-random-values"><a class="header" href="#periodic-columns-and-random-values">Periodic columns and random values</a></h3>
<p>Transition constraints can access the value of any periodic column in the current row, as well as random values provided by the verifier.</p>
<p>To use periodic column values, the periodic column must be declared in the <code>periodic_columns</code> source section. The value in the current row can then be accessed by using the defined identifier of the periodic column.</p>
<p>Random values can be accessed by using array indexing syntax on the <code>rand</code> built-in, as described by the <a href="description/./syntax.html#section-specific-accessors">accessor syntax rules</a>.</p>
<h3 id="example-of-transition-constraints-with-periodic-columns-and-random-values"><a class="header" href="#example-of-transition-constraints-with-periodic-columns-and-random-values">Example of transition constraints with periodic columns and random values</a></h3>
<p>The following is an example of a valid <code>transition_constraints</code> block that uses periodic columns and random values:</p>
<pre><code>def TransitionConstraintsExample

trace_columns:
    main: [a, b]
    aux: [p0, p1]

public_inputs:
    &lt;omitted for brevity&gt;

periodic_columns:
    k: [1, 1, 1, 0]

boundary_constraints:
    &lt;omitted for brevity&gt;

transition_constraints:
    # this is a main constraint that uses a periodic column.
    enf a' = k * a

    # this is an auxiliary constraint that uses a periodic column.
    enf p0' = k * p0

    # these are auxiliary constraints that use random values from the verifier.
    enf b = a + rand[0]
    enf p1 = k * (a + &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;an&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∗&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;+&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;rand[1])
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="example-air-in-airscript"><a class="header" href="#example-air-in-airscript">Example AIR in AirScript</a></h1>
<p>This is an example AIR definition in AirScript that includes all existing AirScript syntax. It is intended to be syntactically demonstrative rather than meaningful.</p>
<pre><code>def ExampleAir

trace_columns:
    main: [s, a, b, c]
    aux: [p]

public_inputs:
    stack_inputs: [16]
    stack_outputs: [16]

periodic_columns:
    k0: [1, 1, 1, 1, 1, 1, 1, 0]

boundary_constraints:
    # define boundary constraints against the main trace at the first row of the trace.
    enf a.first = stack_inputs[0]
    enf b.first = stack_inputs[1]
    enf c.first = stack_inputs[2]

    # define boundary constraints against the main trace at the last row of the trace.
    enf a.last = stack_outputs[0]
    enf b.last = stack_outputs[1]
    enf c.last = stack_outputs[2]

    # set the first row of the auxiliary column p to 1
    enf p.first = 1

transition_constraints:
    # the selector must be binary.
    enf s^2 = s

    # selector should stay the same for all rows of an 8-row cycle.
    enf k0 * (s' - s) = 0

    # c = a + b when s = 0.
    enf (1 - s) * (c - a + b) = 0

    # c = a * b when s = 1.
    enf s * (c - a * b) = 0

    # the auxiliary column contains the product of values of c offset by a random value.
    enf p' = p * (c + &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;an&lt;/span&gt;&lt;span class=&quot;mord mathnormal&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;‘‘‘&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="language-implementation"><a class="header" href="#language-implementation">Language Implementation</a></h1>
<p>This is a high-level overview of the implementation.</p>
<h2 id="parser"><a class="header" href="#parser">Parser</a></h2>
<p>The parser is split into 3 modules:</p>
<ul>
<li>a scanner built using the <a href="https://crates.io/crates/logos">Logos</a> lexer-generator tool</li>
<li>an LR(1) parser generated by the <a href="https://crates.io/crates/lalrpop">LALRPOP</a> parser-generator framework</li>
<li>an AST for representing the parsed AIR description</li>
</ul>
<h2 id="ir"><a class="header" href="#ir">IR</a></h2>
<p>The IR is where semantic checking is done and where optimizations will be done in the future.</p>
<p>A directed acyclic graph called <code>AlgebraicGraph</code> is responsible for efficiently representing all transition constraints, identifying their type (main or auxiliary), and computing their degrees.</p>
<p>Currently, the checks in the IR are very minimal and cover the following simple cases.</p>
<h3 id="identifiers-1"><a class="header" href="#identifiers-1">Identifiers</a></h3>
<ul>
<li>Prevent duplicate identifier declarations.</li>
<li>Prevent usage of undeclared identifiers.</li>
</ul>
<h3 id="periodic-columns"><a class="header" href="#periodic-columns">Periodic columns</a></h3>
<ul>
<li>Ensure the cycle length of periodic columns is valid (greater than the minimum and a power of two).</li>
</ul>
<h3 id="boundary-constraints-1"><a class="header" href="#boundary-constraints-1">Boundary constraints</a></h3>
<ul>
<li>Prevent multiple constraints against the same column at the same boundary.</li>
<li>Ensure boundary constraint expressions contain valid identifier references by:
<ul>
<li>preventing periodic columns from being used by boundary constraints.</li>
<li>ensuring valid indices for public inputs.</li>
</ul>
</li>
<li>Identify boundary constraint types (main or auxiliary), based on the trace column to which the constraint is applied.</li>
</ul>
<h3 id="transition-constraints-1"><a class="header" href="#transition-constraints-1">Transition constraints</a></h3>
<ul>
<li>Ensure transition constraints contain valid identifier references by:
<ul>
<li>Preventing public inputs from being used.</li>
<li>Preventing &quot;next&quot; indicators from being applied to anything other than trace columns.</li>
</ul>
</li>
<li>Identify transition constraint types (main or auxiliary) based on the constraint expression.
<ul>
<li>Constraints referencing the auxiliary trace or using random values are identified as constraints against the auxiliary trace.</li>
<li>All other constraints are identified as constraints against the main trace.</li>
</ul>
</li>
</ul>
<h2 id="winterfell-codegen"><a class="header" href="#winterfell-codegen">Winterfell Codegen</a></h2>
<p>The <code>codegen/winterfell</code> crate provides a code generator for a Rust implementation of the <a href="https://github.com/novifinancial/winterfell">Winterfell prover's</a> <code>Air</code> trait from an instance of an AirScript <code>IR</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
